plugins {
    id 'java'
    id 'groovy'
    id 'jacoco'
    id 'war'
    id 'application'
    id 'com.moowork.grunt' version '0.11'
    id 'com.moowork.node' version '0.11'
    id 'com.github.kt3k.coveralls' version '2.5.0'
}

group 'org.kaakaa'
version '0.0.2'

mainClassName = 'org.kaakaa.pptmuseum.Main'

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
    mavenCentral()
    maven {
        url 'https://repository.apache.org/content/groups/snapshots/'
    }
}

dependencies {
    compile 'com.sparkjava:spark-core:2.3'
    compile 'com.sparkjava:spark-template-jade:2.3'
    compile 'org.mongodb:mongo-java-driver:2.14.1'
    compile 'org.mongodb.morphia:morphia:1.0.0-rc0'
    compile 'net.rakugakibox.util:yaml-resource-bundle:1.1'
    compile 'commons-fileupload:commons-fileupload:1.3.1'
    compile 'org.apache.httpcomponents:httpclient:4.5.1'
    compile 'org.apache.httpcomponents:httpmime:4.5.1'
    compile 'org.apache.pdfbox:pdfbox:2.0.0-SNAPSHOT'
    providedCompile 'org.projectlombok:lombok:1.16.4'

    testCompile 'org.spockframework:spock-core:1.0-groovy-2.4'
}

jar {
    manifest {
        attributes 'Implementation-Title': 'ppt-museum', 'Implementation-Versio': version
        attributes 'Main-Class': mainClassName
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
        csv.enabled false
    }
}

test {
    finalizedBy jacocoTestReport
}

// for installing node
node {
    version = '0.10.22'
    download = true
}

// grunt-browserify
grunt_build.dependsOn 'installGrunt'
grunt_build.dependsOn 'npmInstall'
processResources.dependsOn grunt_build